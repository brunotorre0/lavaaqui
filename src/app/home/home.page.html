<ion-content [fullscreen]="true" [scrollY]="false" class="home-content">
  <div class="home-banner">
    <div class="banner-header">
      <ion-icon class="banner-icon" name="home-outline" aria-hidden="true" (click)="goToHome()"></ion-icon>
      <ion-icon class="banner-icon" name="person-circle-outline" aria-hidden="true" (click)="openAccountMenu($event)"></ion-icon>
    </div>
    <h1 class="banner-title">LavaAqui</h1>
  </div>

  <div class="home-body">
    <button class="location-card" type="button" (click)="openMap()">
      <ion-icon class="location-icon" name="location-outline" aria-hidden="true"></ion-icon>
      <span class="location-label">{{ selectedLaundry ? selectedLaundry.name : 'Morada' }}</span>
      <ion-icon class="location-chevron" name="chevron-forward-outline" aria-hidden="true"></ion-icon>
    </button>

    <div class="selected-map-container" *ngIf="selectedLaundry">
      <iframe
        [src]="selectedLaundryMapUrl"
        [title]="selectedLaundry.name"
        allowfullscreen
        loading="lazy"
        class="selected-map">
      </iframe>
    </div>

    <div class="default-map-container" *ngIf="!selectedLaundry">
      <div class="default-map-placeholder">
        <ion-icon name="map-outline"></ion-icon>
        <p>Selecione uma lavandaria para ver a localização</p>
      </div>
    </div>

    <div class="action-grid">
      <button class="action-card" type="button">
        <ion-icon name="water-outline" aria-hidden="true"></ion-icon>
        <span>Lavar</span>
      </button>
      <button class="action-card" type="button" (click)="goToDrying()">
        <ion-icon name="sunny-outline" aria-hidden="true"></ion-icon>
        <span>Secar</span>
      </button>
      <button class="action-card" type="button" (click)="goToHistory()">
        <ion-icon name="time-outline" aria-hidden="true"></ion-icon>
        <span>Histórico</span>
      </button>
      <button class="action-card" type="button">
        <ion-icon name="log-out-outline" aria-hidden="true"></ion-icon>
        <span>Sair</span>
      </button>
    </div>
  </div>

  <ion-modal [isOpen]="isMapModalOpen" (didPresent)="onMapModalPresent()" (didDismiss)="closeMap()" cssClass="map-modal">
    <ng-template>
      <div class="map-modal-header">
        <button type="button" class="header-icon-button" (click)="closeMap()">
          <ion-icon name="arrow-back-outline" aria-hidden="true"></ion-icon>
        </button>
        <h2 class="map-modal-title">Selecione a loja</h2>
        <button type="button" class="header-icon-button" (click)="centerMapOnUser()">
          <ion-icon name="locate-outline" aria-hidden="true"></ion-icon>
        </button>
      </div>
      <ion-content [scrollY]="false" class="map-content">
        <div id="map"></div>
        <div class="laundry-selection" *ngIf="tempSelectedLaundry">
          <ion-card>
            <ion-card-header>
              <ion-card-title>{{ tempSelectedLaundry.name }}</ion-card-title>
              <ion-card-subtitle>{{ tempSelectedLaundry.address }}</ion-card-subtitle>
            </ion-card-header>
            <ion-card-content>
              <ion-button expand="block" (click)="confirmSelection()" class="select-button">
                Selecionar
              </ion-button>
              <ion-button expand="block" fill="outline" (click)="cancelSelection()" class="cancel-button">
                Cancelar
              </ion-button>
            </ion-card-content>
          </ion-card>
        </div>
      </ion-content>
    </ng-template>
  </ion-modal>

</ion-content>
